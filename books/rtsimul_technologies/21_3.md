[21.2 <--- ](21_2.md) [   Зміст   ](README.md) [--> 21.4](21_4.md)

**21.1**     **USE** **OF** **AUTOSAR** **MODELS** **FOR** **SIMULATION** **AND** **ANALYSIS**

Before going into the technical details on the use of AUTOSAR models for simulation and the discussion of the issues related to model-to-model transformations, it is important to recall what information is necessary for building an AUTOSAR model and at what stage in the development process an AUTOSAR description of the sys- tem should be available. In other words, is the AUTOSAR description the first and authoritative description of the system functions or is it produced later in the devel- opment based on some other models or outputs? Also, we should ask what could be the contribution of simulation performed on an AUTOSAR model to the understand- ing of the system dynamics. This question is relative to the possible advantages and outputs of a system-level simulation (or analysis of other types, including timing and reliability) performed on AUTOSAR models. That is, what can an AUTOSAR model tell us that cannot be obtained in another way?

An initial short answer could be the following: given that AUTOSAR is funda- mentally an empty container for functional behavior descriptions and given its limi- tations in the modeling of continuous-time systems, it is probably (as of now) not a realistic starting point for system-level modeling and analysis, but rather a valuable intermediate formalism that allows a better evaluation of the impact of the software design and coding and of the software–hardware execution platform on the perfor- mance of the controls and the other application functions.

 

**21.1.1**             **U****Se** **oF** **aUToSar** **in The** **d****eVeLoPmenT** **P****roceSS**

A possible use of the AUTOSAR formalism and tools in a development process is therefore the following:

 

•   The system functionality, including the system controls, are modeled in a suitable language (e.g., Simulink), together with the plant model, and vali- dated by simulation with logical execution time assumptions. In case the controller (re)uses AUTOSAR SWCs, possibly imported in Simulink.

•   The execution platform for the system is selected and modeled in an AUTOSAR environment.



**538**                                       Real-Time Simulation Technologies

 

•   The functional model is translated into a corresponding AUTOSAR set of com- ponents, some functionality is possibly realized by reusing existing component models, and the virtual AUTOSAR model resulting from the composition is mapped onto the execution architecture according to the AUTOSAR process.

•   The result of the mapping stage, performed by the AUTOSAR tools, is the definition of the communication matrix, the task model, and the configuration of the RTE and BSW levels. This definition now allows the simulation of the system functions considering platform-related issues, including the simula- tion of not only the actual code implementing the application functions but also the code for the communication services and the basic services, with the operating system and the device drivers and the actual network message set.

 

Although other options are possible, this is a flow that exploits AUTOSAR strengths and attempts to overcome its limitations.

 

**21.1.2**             **S****imULaTion aT The** **VFB (****and** **B****ehaVior****) L****eVeL**

This is the first option, the one commonly provided by commercial tools and possi- bly the one without clear advantages with respect to other competing methods since the peculiarity of an AUTOSAR model should be the availability of architecture- specific information, including the tasking and message model and the scheduling information. VFB-level simulation focuses on the higher level of the functional behavior of applications within the context of three layers of abstraction: the inter- face definition, the behavior definition, and the implementation definition.

For the interface definition layer, the ports and the associated interfaces of a SWC communicating with other components and underlying BSW services are validated and verified. For the behavioral layer, runnables are validated and verified in terms of their execution semantics with respect to their triggering and activation sources. Since there is no model for the RTE and BSW, the events that are relevant for simula- tion are the set of (simulated) RTE periodic events and the Call and Write events on, respectively, Sender and Receiver ports.

The implementation layer addresses the validation and verification of resource consumption. In particular, if this layer is fully defined, the time when events are generated can be inferred using the worst-case execution time attribute of each run- nable. If this information is not available, the runnable execution is simulated to occur in zero logical time [13]. In a VFB-level simulation, the RTE is emulated on the selected simulation platform with its operating system, omitting details about the actual RTE implementation, the task model, and the execution platform.

 

**21.1.3**             **S****imULaTion aT The** **rTe L****eVeL**

The next level is the simulation of the system including the set of RTE calls and the RTE overheads. This requires availability of an RTE generator that provides the corresponding code. The simulation at the RTE level adds little to the previous step since it allows to verify the system functions with the *actual code* that performs the data communication over ports and the generation of events.



Specification and Simulation of Automotive Functionality                **539**

 

**21.1.4**             **S****imULaTion aT The** **BSW L****eVeL****: F****rom** **ecU-L****eVeL** **S****imULaTion To** **F****ULL** **a****rchiTecTUre** **m****odeLing**

This final simulation level includes the possibility of modeling components at the BSW level, including the tasking model, the operating system, and the device driv- ers. Simulation at the BSW level can be performed not only at the ECU level but also at the system level, assuming availability of an architecture model, which allows the emulation of the ECUs and the network. Also, availability of the entire software stack at this point fully enables HIL simulation. This is indeed supported by the dSPACE development toolchain allowing ECU-level HIL simulation on the (micro) autobox platforms.

For the timing evaluation at the ECU level with platform models, there is little support from commercial tools.

An example of performance evaluation of AUTOSAR-based systems applied to a power window case study is described in Ref. [14], where an AUTOSAR application description is translated into a Discrete Event System Specification (DEVS) and then simulated using a DEVS engine. DEVS is a formalism for modeling discrete event systems in a hierarchical and modular way [15,16]. In Ref. [14], a DEVS model of the AUTOSAR BSW layers was used to simulate the real-time characteristics of the power window system. The execution times of all relevant actions were esti- mated by measurements on a MPC560xP microcontroller running at 64 MHz with an AUTOSAR BSW generated using Tresos AutoCore. The source code was com- piled using the MULTI compiler of Green Hills Software. The measures included the execution time of all the runnables for any possible state (without the calls to the RTE); the execution time required for activating or suspending tasks and the context switch times; and the execution time of the writing and receiving of messages in every part of the communication stack including the RTE. The semantics of DEVS is indeed suited for matching the event model of AUTOSAR, and the simulation results were found to be a good match of the observed execution on the actual hard- ware target. The model included not only the AUTOSAR BSW but also a model of the controller area network (CAN) bus.

Another example of ECU-level modeling effort coupling the description of AUTOSAR SWCs with the BSW generation and an architecture model defined in SystemC is provided in Ref. [17]. As in the previously cited work, the objective is to evaluate the timing behavior of AUTOSAR components taking into account the underlying hardware and communication paths.

In Ref. [17], a formal correspondence was established between AUTOSAR modeling concepts and the corresponding SystemC design concepts [18] at dif- ferent levels of abstraction (e.g., AUTOSAR runnables map onto SystemC pro- cesses). When considering the RTE and the BSW levels, the AUTOSAR design can be translated into a SystemC Programmer View where timing information is provided by timing annotations (in terms of execution cycles). Therefore, if the implementation software exists (e.g., after generation by the RTE generators and BSW configurators), the timing behavior of the software can be evaluated by cycle-level simulation on SystemC models of the hardware platform using the SystemC simulation engine [19].



**540**                                       Real-Time Simulation Technologies

 

Additional research works [18,19] discuss simulation options for distributed plat- forms. In this case, of course, a model of the network adapter and the communica- tion network must be provided. The case of CAN communication is discussed in the models in Ref. [14], and a FlexRay network model is part of the use case showing the applicability of the method proposed in Ref. [17].

[21.2 <--- ](21_2.md) [   Зміст   ](README.md) [--> 21.4](21_4.md)