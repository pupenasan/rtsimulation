[7.1 <--- ](7_1.md) [   Зміст   ](README.md) [--> 7.3](7_3.md)

## 7.2. PSBD FOR NETWORKED REAL-TIME EMBEDDED SYSTEMS

This section provides an overview of the PSBD methodology [3] and develops a bifurcated design process for networked real-time embedded systems.

 

**7.1.1**  **PSBD** **O****verview**

PSBD views simulation as the driving force for designing and testing engineering systems. It provides a design process that explicitly focuses on systematic transitions from simulation models to system realization. As shown in [Figure 7.1](#_bookmark40), the design process consists of three stages, each of which is characterized by the types of entities (virtual or physical) that are involved. The first stage is *conventional simulation* (in fast simulation mode), where simulation is carried out using all models. A major task of this stage is to develop the system model based on available knowledge and assumptions about the hardware and operating environment of the physical system. Often discrepancies between simulation models and physical system components exist. These discrepancies cause the models to comprise behavior different from the system behavior. To reveal such design discrepancies, the next stage of the design process is *virtual environment simulation* (in real-time simulation mode), where



**184**                             Real-Time Simulation Technologies

 

​                                 Model world                                                                            Physical world

 



 

 

Models (conventional simulation)



Replace model with physical system

Update model





 

Models and physical system components (virtual environment simulation)



Replace model with physical system

Update model





 

Physical system (system experiment in operating environment)



 

Final system measurement and evaluation

**FIGURE 7.1** Progressive simulation-based design methodology.

simulation-based study is carried out in a virtual testing environment using combined models and physical system components. This stage brings simulation-based study one step closer to a realization by including physical system components into the simulation. The goal is to use physical system components to reveal overlooked design details, and thus help designers improve the control models/algorithms under development. The final stage is *physical system experiment*, where the physical system is tested in the target operating environment.

Along this design process, the PSBD methodology emphasizes two parallel activities in a progressive manner: *replace models with physical system components* and *update models*. As the design moves forward, physical system components are incrementally brought into the simulation to replace models. Simulations with these physical system components allow designers to validate their design assumptions and to reveal new design details. Such information is fed back to the previous stages to update the models if necessary. The updated model will then be used for follow-on design and test. This activity of model update allows designers to maintain a coherent model of the system under development. Thus, at the end of the design, not only the system is realized and tested, but also a system model that faithfully represents the system is developed. This system model can support final system measurement and evaluation (shown by the dashed line in Figure 7.1) and serve other purposes such as system maintenance and future development. It is important to note that each design stage is a dynamically evolving process by itself. For example, during the conventional simulation stage, it is common for designers to start from high level models and then refine them to more detailed models. Similarly, the virtual environment simulation stage that involves combined models and physical system components typically includes multiple phases too, for example, to start with replacing one physical system component first and then gradually add more.

Two important features of the PSBD methodology are *model continuity* and *virtual environment simulation* that supports simulation-based test with combined virtual and physical system components. Model continuity refers to the ability to transition as much as possible of a model specification through the stages of a development process [17]. For real-time embedded systems, we restrict model continuity to the models (software components) that implement the real-time control of the system. This means the control models of a real-time embedded system are designed, analyzed, and tested by simulation methods and then smoothly transitioned from



Progressive Simulation-Based Design                            **185**

 

simulation to hardware execution in the physical environment (see Hu et al. [4] and Azarnasab [6] for more details). To support model continuity, it is necessary to develop system models and run simulation-based tests in a systematic way. A modular design and well-defined interfaces are necessary to ensure the control models work with physical and simulated hardware in the same way at different stages of the design process [4,6]. The virtual environment simulation provides a virtual testing environment by using combined physical and virtual system components. It bridges the gap between conventional simulations that use all models and physical system experiments that use all physical system components. To support the virtual environment, simulation techniques must be developed that synchronize the physical and virtual system components. This includes allowing the physical and virtual components to “sense” each others’ existence (see Hu and Zeigler [18] for an example of how physical and virtual robots are synchronized with each other). Meanwhile, time synchronization is also important. Since hardware components are included in the simulation-based study, real-time simulations are necessary to support the virtual testing environment.

 

**7.1.2**  **B****ifurcateD** **D****eSign** **P****rOceSS** **fOr** **n****etwOrkeD** **r****eal****-t****ime** **e****mBeDDeD** **S****yStemS**

Networked real-time embedded systems are characterized by a network of embedded devices interacting with each other and the tight couplings between software and hardware of those devices. Each of these devices is referred to as a *node* in this chapter. When commercial-off-the-shelf (COTS) nodes are not used, design of networked real-time embedded systems must design both the individual nodes and the networked system as a whole. Within this context, the PSBD methodology described above is elaborated to include a bifurcated design process as shown in [Figure 7.2](#_bookmark41). The bifurcated design process explicitly differentiates the design of a single node (the bottom route in Figure 7.2) and the design of the networked system (the top route in Figure 7.2). The former mainly concerns designing the different functional modules, such as sensing, modulation/demodulation, and channel coding, of the embedded device. The latter focuses on how the multiple nodes work together as a whole, including designing and improving the communication protocols and the cooperative strategies among the nodes. Despite the different design focuses, both designs follow the PSBD process that starts from models and gradually adds more physical system components.

In Figure 7.2, the models are shown as white boxes; the physical system components are shown as grey boxes. The design starts and bifurcates into two routes: the design of a single node and the design of the networked system. For designing a single node, the first step is to model the functional modules of the embedded device and simulate how they work together to fulfill the functionality of the device. Then hardware components are brought into the design and HIL simulations are conducted to test how well the designed modules and algorithmic code work with the hardware. This proceeds in a stepwise fashion as more and more hardware components are included. Consider the CR (described later) as an example, first the channel sensing mechanism is implemented on the FPGA and DSP hardware, then the data transmission



**186**                             Real-Time Simulation Technologies

 

 

 

 

 

 

​                 

​          Design the networked system          

​          Model node 2          

​          Model node 3          

​          Real node 2          

​          Model node 3          

​          node          

​          Real 2          

​          Real node 3          

​          Network     model          

​          Network     model          

​          Real     network          

​          Model node 1          

​          Model node 4          

​          node          

​          Real 1          

​          Model node 4          

​          node          

​          Real 1          

​          Real node 4          

​          art          

​          Sensing          

​          Modulation          

​          Sensing          

​          Modulation          

​          Sensing          

​          Modulation          

​          Design a single node          

​          Channel coding          

​          Channel coding          

​          Channel coding          

​          Synchronization          

​          Synchronization          

​          Synchronization          

​          MAC layer          

​          MAC layer          

​          MAC layer          

​          Simulation with all models          

​          Simulation with models and real system components          

​          Execution with all real system components          



St



 

 

 

 

 

 

 

 

 

**FIGURE 7.2** A bifurcated design process for networked real-time embedded system.

 

and data reception components are included, and finally the reporting mechanism is implemented. We use a signal generator and signal analyzer to help to test the developed components before a working node is complete. Eventually, all the code modules are implemented in the hardware and the embedded node is tested with all hardware components.

When designing the networked system, the first step is to develop individual node models and a model of the communicating network. The individual node model can reuse the model from designing the single node (as indicated by the dotted arrow in Figure 7.2). Alternatively, a different node model at a higher abstraction level (e.g., without including all the details of the devices’ functional modules) can be used. Simulations with these models allow designers to test the networked system in the model world. The next step is to gradually include physical device nodes into the simulation-based study to conduct virtual environment simulations. The physical device nodes are either the ones from the single node design or COTS nodes. This continues until the entire system is realized and all designed nodes are tested in a physical network. It is important to note that the bifurcated design process provides a systematic view for designing general networked embedded systems. For a specific application, the design process can be tailored (e.g., some design stages are elaborated while others are omitted) to fit the specific design needs of the application. In Section 7.4, we provide an example of designing a CR system by starting from the design of a single radio modem and then proceeding to the design of a CR network. The single radio modem is also designed in progressive manner, where different functional modules are gradually implemented/tested in the hardware while other modules are provided by simulation models.

PSBD brings several advantages when designing complex networked engineering systems. Some of them are shared by the traditional HIL simulation. For example, it brings simulation-based study one step closer to the reality to provide useful information for designers. It also increases confidence by the designer about how



Progressive Simulation-Based Design                             **187**

 

the final system will operate. However, PSBD goes beyond that by emphasizing a systematic design process that gradually adds more physical system components to replace simulation models. The virtual environment simulation provides the flexibility for experimenting with a design in a virtual testing environment. It allows designers to use several, instead of all, physical nodes to carry out a system-wide test of a networked system. This is especially useful for large-scale networked realtime embedded systems whose complexity and scale severely limit experimentations in a physical environment using all physical nodes. As the scale of these systems increases, so does their design and test complexity. It is the intent of PSBD to systematically handle such design complexity in a progressive manner.

[7.1 <--- ](7_1.md) [   Зміст   ](README.md) [--> 7.3](7_3.md)