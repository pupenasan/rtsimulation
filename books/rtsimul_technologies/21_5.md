[21.4 <--- ](21_4.md) [   Зміст   ](README.md) [--> 21.6](21_6.md)

**21.1**     **SIMULATION,** **TIMING** **ANALYSIS,** **AND** **CODE** **GENERATION:** **CONSISTENCY ISSUES AND MODEL ALIGNMENT**

An AUTOSAR model has (at least) three different objectives: it can be used to simulate the functional behavior, it can be used to perform worst-case timing analysis using suitable tools and, of course, it is used to generate the code for the implementation of the model on a target platform. The same model should be used for the three purposes or at least very limited changes should be required to obtain the three different objectives of validation by timing analysis, simulation, and finally automatic implementation by code generation.

To illustrate some of the issues, let us consider a fuel injection system. In this control application, several functions must be executed in response to events that correspond to a given rotation angle of the engine shaft. In practice, a crankshaft position sensor provides a reference hardware signal that is sporadic in nature and depends on the rotation speed of the shaft. This signal triggers a set of functions, typically mapped for execution onto a single task.

In AUTOSAR, a sporadic signal of this type cannot be directly defined as an RTE event. However, inside the application model, the runnables that are executed in response to the crankshaft position signal must be activated in response to an RTE event, given that this is the only legal way for a runnable to be activated in AUTOSAR.

One possible solution is the following. A BSW runnable represents the interface between the hardware signal coming from the crankshaft position sensor and the application tasks. This BSW runnable writes into a sender/receiver port to forward to the application the sensor position signal. The SWCs containing application runnables that must be activated in response to this signal will define a matching port. Inside them, the runnables are then defined to be activated on the event of data received on the port.

The BSW component is the main variation point with respect to the three model versions. For simulation purposes, the BSW runnable is activated periodically by a counter/alarm pair. Inside, it contains the simulation stub that generates the stream of the crankshaft sensor signals. These signals are represented by writes into the sender/receiver port on which all the application-level runnables that must perform actions in correspondence to these events are waiting.

For code generation purposes, the BSW component is replaced by a device driver that will explicitly call the RTE API function for writing into the data port at the end of its execution.

Finally, for the purpose of worst-case timing analysis, it is necessary to have information about the worst-case arrival rate of the activation events for the sporadic task onto which all the runnables reacting to the crankshaft position sensor events are mapped. In AUTOSAR 4.0, this indication could come directly from a timed event triggering information ([Figure 21.8](#_bookmark128)). In past releases of the standard, a timing analysis tool would have to deduce the rate from the rate of the writes into the corresponding data port, which would require navigating the communication model graph to the BSW runnable and the corresponding alarm (which, however, can only be periodic since no AUTOSAR versions up to 3.2 allow sporadic activation events)

[21.4 <--- ](21_4.md) [   Зміст   ](README.md) [--> 21.6](21_6.md)