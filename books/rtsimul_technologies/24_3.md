[24.2 <--- ](24_2.md) [   Зміст   ](README.md) [--> 24.4](24_4.md)

## 24.3 SIMULATION WITH LINEAR VELOCITY CONSTRAINTS

The aim in this section is to derive a minimal order system of ODEs, which satisfies the unconstrained dynamics in Equation 24.3, subject to the system of linear constraints on the velocities in Equation 24.6. The basis for the derivation is that a system of *n* dynamic equations subject to *m* constraints can be reduced to a system of equations with *v* = *n* − *m* independent states.

Метою цього розділу є отримання системи мінімального порядку ОДУ, яка задовольняє необмежену динаміку в рівнянні 24.3, підпорядковану системі лінійних обмежень на швидкості в рівнянні 24.6. Основою для виведення є те, що система *n* динамічних рівнянь з обмеженнями *m* може бути зведена до системи рівнянь з *v* = *n* − *m* незалежними станами.

### 24.3.1 Reduced Order State Vector

The relationship between the full state vector (**v**) and the reduced set of independent states (**v** ) is through the transformation matrix **α** in Equation 24.7.

Зв’язок між повним вектором стану (**v**) і скороченим набором незалежних станів (**v**) визначається через матрицю перетворення **α** в рівнянні 24.7.

![image-20220823011942959](media/image-20220823011942959.png)

The transformation matrix **α** is not unique but has to be determined so that the full state vector will always satisfy the constraint equations. This can be achieved if the columns of **α** form the basis vectors of the null space of the constraint equations. If **α** satisfies that requirement, then the inner matrix product in Equation 24.8 will be satisfied for all values of the independent states.

Матриця перетворення **α** не є унікальною, але має бути визначена так, щоб повний вектор стану завжди задовольняв рівняння обмежень. Цього можна досягти, якщо стовпці **α** утворюють базисні вектори нульового простору рівнянь обмежень. Якщо **α** задовольняє цю вимогу, тоді внутрішній матричний добуток у рівнянні 24.8 буде задоволено для всіх значень незалежних станів.

![image-20220823011955963](media/image-20220823011955963.png)

One method for deriving **α** is given in Ref. [8]. In this case, the independent states are selected to be a subset of the full state vector as shown in Equation 24.9.

Один метод отримання **α** наведено в Ref. [8]. У цьому випадку незалежні стани вибираються як підмножина повного вектора стану, як показано в рівнянні 24.9.

![image-20220823012011869](media/image-20220823012011869.png)

If the constraint matrix is partitioned as in Equation 24.10, then **v**ˆ can be defined in terms of **v** , and α is given by Equation 24.11.

Якщо матриця обмежень розділена, як у рівнянні 24.10, тоді **v**ˆ можна визначити через **v**, а α задано рівнянням 24.11.

![image-20220823012027111](media/image-20220823012027111.png)

This approach works well provided the selection of the independent states leads to a tractable system of linear equations (i.e., **W2** is invertible). Making a suitable selection is not always straightforward either when there are a large number of states or when there are a large number of models to be analyzed. An alternative approach described in Ref. [9] uses the singular value decomposition (SVD) of the constraint matrix to derive the basis vectors of the null space at each time step during the simulation. This provides a robust and numerically stable approach, but can be computationally expensive and leads to the integration of states that are not directly related to the physical states of the system.

Цей підхід добре працює за умови, що вибір незалежних станів веде до системи лінійних рівнянь, що піддається обробці (тобто **W2** є оберненим). Зробити відповідний вибір не завжди просто, якщо існує велика кількість станів або коли існує велика кількість моделей, які потрібно проаналізувати. Альтернативний підхід, описаний у Ref. [9] використовує сингулярне розкладання (SVD) матриці обмежень для отримання базисних векторів нульового простору на кожному кроці часу під час моделювання. Це забезпечує надійний і чисельно стабільний підхід, але може бути обчислювально дорогим і призводить до інтеграції станів, які безпосередньо не пов’язані з фізичними станами системи.

The approach taken is to determine which states can be selected as independent states before creating the simulation model. There are functions available in MathWorks Symbolic Math Toolbox™ [10] to derive the null space of the constraint matrix symbolically, and as the form of the resulting matrix is the same as in Equation 24.7, the independent states can be determined by a simple inspection of the rows of the matrix for a single entry of a unit gain. Within the simulation model, the null space matrix is regenerated using the indices of the selected states to be integrated and the formulation in Equation 24.11. The main benefit of doing this is that only a minimal amount of information must be stored with the model to define the independent state vector for each mode. 

Використаний підхід полягає в тому, щоб визначити, які стани можна вибрати як незалежні стани перед створенням імітаційної моделі. Існують функції, доступні в MathWorks Symbolic Math Toolbox™ [10] для символічного отримання нульового простору матриці обмежень, і оскільки форма результуючої матриці є такою ж, як у рівнянні 24.7, незалежні стани можна визначити простим оглядом рядків матриці для одного запису одиничного підсилення. У імітаційній моделі матриця нульового простору регенерується з використанням індексів вибраних станів, які потрібно інтегрувати, і формулювання в рівнянні 24.11. Основна перевага цього полягає в тому, що лише мінімальний обсяг інформації повинен зберігатися в моделі для визначення незалежного вектора стану для кожного режиму.

### 24.3.2 Minimum Order Momentum Equations

The minimum order dynamic equations can be derived once the relationship between the full and the reduced order state vectors has been established. The time derivative of the full state vector is related to the reduced state vector by Equation 24.12.

Динамічні рівняння мінімального порядку можуть бути отримані після встановлення зв’язку між векторами стану повного та зниженого порядку. Похідна за часом повного вектора стану пов’язана зі скороченим вектором стану рівнянням 24.12.

![image-20220823012103597](media/image-20220823012103597.png)

Substituting Equation 24.12 into the unconstrained dynamic equations in Equations 24.3 and projecting the equations onto the constraint manifold by multiplying through by **α**T leads to a minimum order system of ODEs that have the form given by Equation 24.13. The forcing function **F** in Equation 24.13 is given by Equation 24.14, and the mass matrix **M** is given by Equation 24.15.

Підставляючи рівняння 24.12 у необмежені динамічні рівняння в рівняннях 24.3 і проектуючи рівняння на багатоманітність обмежень шляхом множення на **α**T, веде до системи мінімального порядку ОДУ, які мають форму, задану рівнянням 24.13. Функція форсування **F** у рівнянні 24.13 задана рівнянням 24.14, а матриця маси **M** задана рівнянням 24.15.

 ![image-20220823012118417](media/image-20220823012118417.png)

### 24.3.3 Junction Press ures and Reaction Forces

The reduction procedure described in Section 24.3.2 creates a system of ODEs that can be simulated using standard solvers. In the process, the constraint forces have been lost from the model description. The first stage to regenerate these forces is to derive an expression for the rate of change of the dependent states as a function of the independent states. If the constraint matrix is partitioned in Equation 24.10, then after differentiation, it can be rearranged to give the expression for **v**ˆ in Equation 24.16.

Процедура редукції, описана в розділі 24.3.2, створює систему ODE, яку можна моделювати за допомогою стандартних вирішувачів. У цьому процесі сили обмеження були втрачені з опису моделі. Першим етапом відновлення цих сил є отримання виразу для швидкості зміни залежних станів як функції незалежних станів. Якщо матриця обмежень розділена в рівнянні 24.10, то після диференціювання її можна перебудувати, щоб отримати вираз для **v**ˆ у рівнянні 24.16.

![image-20220823012150870](media/image-20220823012150870.png)

The dynamic equations in Equation 24.3 can also be partitioned as shown in Equation 24.17. The unknown internal forces can be regenerated by substituting Equation 24.16 into Equation 24.17 and rearranging to give Equation 24.18.

Динамічні рівняння в рівнянні 24.3 також можна розділити, як показано в рівнянні 24.17. Невідомі внутрішні сили можна відновити, замінивши рівняння 24.16 на рівняння 24.17 і переставивши, щоб отримати рівняння 24.18.

![image-20220823012207533](media/image-20220823012207533.png)

 

[24.2 <--- ](24_2.md) [   Зміст   ](README.md) [--> 24.4](24_4.md)