[24.2 <--- ](24_2.md) [   Зміст   ](README.md) [--> 24.4](24_4.md)

**24.1**     **SIMULATION** **WITH** **LINEAR** **VELOCITY** **CONSTRAINTS**

The aim in this section is to derive a minimal order system of ODEs, which satis- fies the unconstrained dynamics in Equation 24.3, subject to the system of linear constraints on the velocities in Equation 24.6. The basis for the derivation is that a system of *n* dynamic equations subject to *m* constraints can be reduced to a system

of equations with *v* = *n* − *m* independent states.

**24.1.1**             **r****educed** **o****rder** **S****tate** **V****ector**

The relationship between the full state vector (**v**) and the reduced set of independent states (**v** ) is through the transformation matrix **α** in Equation 24.7.

**v** = **a** **v**                      (24.7)

The transformation matrix **α** is not unique but has to be determined so that the full state vector will always satisfy the constraint equations. This can be achieved if the columns of **α** form the basis vectors of the null space of the constraint equations. If **α** satisfies that requirement, then the inner matrix product in Equation 24.8 will be satisfied for all values of the independent states.

**W**T **v** = (**W**T **a**) **v** = **0**



  

=0



(24.8)



One method for deriving **α** is given in Ref. [8]. In this case, the independent states are selected to be a subset of the full state vector as shown in Equation 24.9.



**v** = é **I 0** ù é **v** ù





(24.9)



ë    û ê **v**ˆ ú

ë û

If the constraint matrix is partitioned as in Equation 24.10, then **v**ˆ can be defined in terms of **v** , and α is given by Equation 24.11.



**W**T **v** = é **W**T **W**T ù é **v** ù = **0**





(24.10)



ë   1      **2** û ê **v**ˆ ú



ë û

**v** = é **v** ù = **a****v** = é    **I***v*       ù **v** 





 

(24.11)



ê **v**ˆ ú



ê -**W**- T **W**T ú



ë  û        êë   2      1 úû

This approach works well provided the selection of the independent states leads to a tractable system of linear equations (i.e., **W2** is invertible). Making a suitable selection is not always straightforward either when there are a large number of states or when there are a large number of models to be analyzed. An alternative approach described in Ref. [9] uses the singular value decomposition (SVD) of the constraint matrix to derive the basis vectors of the null space at each time step during the simu- lation. This provides a robust and numerically stable approach, but can be computa- tionally expensive and leads to the integration of states that are not directly related to the physical states of the system.



Systematic Derivation of Hybrid System Models for Hydraulic Systems      **605**

 

The approach taken is to determine which states can be selected as indepen- dent states before creating the simulation model. There are functions available in MathWorks Symbolic Math Toolbox™ [10] to derive the null space of the con- straint matrix symbolically, and as the form of the resulting matrix is the same as in Equation 24.7, the independent states can be determined by a simple inspection of the rows of the matrix for a single entry of a unit gain. Within the simulation model, the null space matrix is regenerated using the indices of the selected states to be integrated and the formulation in Equation 24.11. The main benefit of doing this is that only a minimal amount of information must be stored with the model to define the independent state vector for each mode.

 

**24.1.2**              **m****inimum** **o****rder** **m****omentum** **e****quationS**

The minimum order dynamic equations can be derived once the relationship between the full and the reduced order state vectors has been established. The time derivative of the full state vector is related to the reduced state vector by Equation 24.12.

 



**v** = **a** **v** + **a****v** 



(24.12)



 

Substituting Equation 24.12 into the unconstrained dynamic equations in Equations 24.3 and projecting the equations onto the constraint manifold by mul- tiplying through by **α**T leads to a minimum order system of ODEs that have the form given by Equation 24.13. The forcing function **F** in Equation 24.13 is given by

Equation 24.14, and the mass matrix **M** is given by Equation 24.15.

 

**M** **v** = **F** (**v** )                    (24.13)

 



**F** (**v** ) = **a**T**F** (**v** ) - (**a**T**M****a** )**v** 





(24.14)



 



**M** = **a**T **M****a**



(24.15)



 

**24.1.3**              **J****u****n****c****t****i****o****n** **P****reSSureS** **and** **r****eaction** **f****orceS**

The reduction procedure described in Section 24.3.2 creates a system of ODEs that can be simulated using standard solvers. In the process, the constraint forces have been lost from the model description. The first stage to regenerate these forces is to derive an expression for the rate of change of the dependent states as a func- tion of the independent states. If the constraint matrix is partitioned in Equation 24.10, then after differentiation, it can be rearranged to give the expression for **v**ˆ in Equation 24.16.

 



​        

​        2                  1        



vˆ = -**W**- T (**W** T **v** + **W**T **v** )







(24.16)



**606**                                       Real-Time Simulation Technologies

 

The dynamic equations in Equation 24.3 can also be partitioned as shown in Equation 24.17. The unknown internal forces can be regenerated by substituting Equation 24.16 into Equation 24.17 and rearranging to give Equation 24.18.



 

é **M**   **0**





ù é ù



é **W** ù é **P****J** ù





é **F** ù



ê   **1**     ú ê **v** ú + ê



1 ú ê **F**  ú = ê **1** ú



(24.17)



**0 M**     ˆ 



**W**   ê   **R** ú    **F**



 ê      **2** úû êë **v** úû êë



2 úû ê **D****P** ú



 ê **2** úû



 

é **P****J** ù



ë   **C** û



​     

​        ê        



​        **R**        



​        ú        



​        2        



​        **2**        **2**        



​        2                  1        



ê **F**  ú = **W**-1 (**F**





\+ **M W**- T (**W** T **v** + **W**T **v** ))



(24.18)



ê **D****P****C** ú

ë     û

 

[24.2 <--- ](24_2.md) [   Зміст   ](README.md) [--> 24.4](24_4.md)